
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Internal query processing &#8212; semantique 0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script src="../_static/documentation_options.js?v=a1637f0b"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_notebooks/processor';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../reference.html" />
    <link rel="prev" title="Verbs" href="verbs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_light.png" class="logo__image only-light" alt="semantique 0.1.0 documentation - Home"/>
    <script>document.write(`<img src="../_static/logo_dark.png" class="logo__image only-dark" alt="semantique 0.1.0 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../guide.html">User Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="recipes.html">Writing and executing query recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="mapping.html">Constructing mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="datacube.html">Representing EO data cubes</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="verbs.html">Verbs</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Internal query processing</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.QueryRecipe.html">semantique.QueryRecipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.mapping.Mapping.html">semantique.mapping.Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.mapping.Semantique.html">semantique.mapping.Semantique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.datacube.Datacube.html">semantique.datacube.Datacube</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.datacube.Opendatacube.html">semantique.datacube.Opendatacube</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.datacube.GeotiffArchive.html">semantique.datacube.GeotiffArchive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.extent.SpatialExtent.html">semantique.extent.SpatialExtent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.extent.TemporalExtent.html">semantique.extent.TemporalExtent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.concept.html">semantique.concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.entity.html">semantique.entity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.event.html">semantique.event</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.layer.html">semantique.layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.appearance.html">semantique.appearance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.artifacts.html">semantique.artifacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.atmosphere.html">semantique.atmosphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reflectance.html">semantique.reflectance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.topography.html">semantique.topography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.result.html">semantique.result</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.self.html">semantique.self</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.collection.html">semantique.collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.evaluate.html">semantique.ArrayProxy.evaluate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.extract.html">semantique.ArrayProxy.extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.filter.html">semantique.ArrayProxy.filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.filter_time.html">semantique.ArrayProxy.filter_time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.filter_space.html">semantique.ArrayProxy.filter_space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.assign.html">semantique.ArrayProxy.assign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.assign_time.html">semantique.ArrayProxy.assign_time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.assign_space.html">semantique.ArrayProxy.assign_space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.groupby.html">semantique.ArrayProxy.groupby</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.groupby_time.html">semantique.ArrayProxy.groupby_time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.groupby_space.html">semantique.ArrayProxy.groupby_space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.reduce.html">semantique.ArrayProxy.reduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.shift.html">semantique.ArrayProxy.shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.smooth.html">semantique.ArrayProxy.smooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.trim.html">semantique.ArrayProxy.trim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.delineate.html">semantique.ArrayProxy.delineate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.fill.html">semantique.ArrayProxy.fill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.apply_custom.html">semantique.ArrayProxy.apply_custom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.compose.html">semantique.CollectionProxy.compose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.concatenate.html">semantique.CollectionProxy.concatenate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.merge.html">semantique.CollectionProxy.merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.evaluate.html">semantique.CollectionProxy.evaluate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.extract.html">semantique.CollectionProxy.extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.filter.html">semantique.CollectionProxy.filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.filter_time.html">semantique.CollectionProxy.filter_time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.filter_space.html">semantique.CollectionProxy.filter_space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.assign.html">semantique.CollectionProxy.assign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.assign_time.html">semantique.CollectionProxy.assign_time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.assign_space.html">semantique.CollectionProxy.assign_space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.reduce.html">semantique.CollectionProxy.reduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.shift.html">semantique.CollectionProxy.shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.smooth.html">semantique.CollectionProxy.smooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.trim.html">semantique.CollectionProxy.trim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.delineate.html">semantique.CollectionProxy.delineate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.fill.html">semantique.CollectionProxy.fill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.CollectionProxy.apply_custom.html">semantique.CollectionProxy.apply_custom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.ArrayProxy.name.html">semantique.ArrayProxy.name</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.label.html">semantique.label</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.set.html">semantique.set</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.interval.html">semantique.interval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.geometry.html">semantique.geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.time_instant.html">semantique.time_instant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.time_interval.html">semantique.time_interval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.dimensions.TIME.html">semantique.dimensions.TIME</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.dimensions.SPACE.html">semantique.dimensions.SPACE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.dimensions.X.html">semantique.dimensions.X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.dimensions.Y.html">semantique.dimensions.Y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.YEAR.html">semantique.components.time.YEAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.SEASON.html">semantique.components.time.SEASON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.QUARTER.html">semantique.components.time.QUARTER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.MONTH.html">semantique.components.time.MONTH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.WEEK.html">semantique.components.time.WEEK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.DAY.html">semantique.components.time.DAY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.DAY_OF_WEEK.html">semantique.components.time.DAY_OF_WEEK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.DAY_OF_YEAR.html">semantique.components.time.DAY_OF_YEAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.HOUR.html">semantique.components.time.HOUR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.MINUTE.html">semantique.components.time.MINUTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.time.SECOND.html">semantique.components.time.SECOND</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.space.X.html">semantique.components.space.X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.space.Y.html">semantique.components.space.Y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.components.space.FEATURE.html">semantique.components.space.FEATURE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.NOT.html">semantique.operators.NOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.IS_MISSING.html">semantique.operators.IS_MISSING</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.NOT_MISSING.html">semantique.operators.NOT_MISSING</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.ABSOLUTE.html">semantique.operators.ABSOLUTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.EXPONENTIAL.html">semantique.operators.EXPONENTIAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.CUBE_ROOT.html">semantique.operators.CUBE_ROOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.NATURAL_LOGARITHM.html">semantique.operators.NATURAL_LOGARITHM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.SQUARE_ROOT.html">semantique.operators.SQUARE_ROOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.FLOOR.html">semantique.operators.FLOOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.CEILING.html">semantique.operators.CEILING</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.COSINE.html">semantique.operators.COSINE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.SINE.html">semantique.operators.SINE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.TANGENT.html">semantique.operators.TANGENT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.SECANT.html">semantique.operators.SECANT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.COSECANT.html">semantique.operators.COSECANT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.COTANGENT.html">semantique.operators.COTANGENT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.TO_DEGREES.html">semantique.operators.TO_DEGREES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.TO_RADIANS.html">semantique.operators.TO_RADIANS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.ADD.html">semantique.operators.ADD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.DIVIDE.html">semantique.operators.DIVIDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.MULTIPLY.html">semantique.operators.MULTIPLY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.POWER.html">semantique.operators.POWER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.SUBTRACT.html">semantique.operators.SUBTRACT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.NORMALIZED_DIFFERENCE.html">semantique.operators.NORMALIZED_DIFFERENCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.AND.html">semantique.operators.AND</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.OR.html">semantique.operators.OR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.EXCLUSIVE_OR.html">semantique.operators.EXCLUSIVE_OR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.EQUAL.html">semantique.operators.EQUAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.NOT_EQUAL.html">semantique.operators.NOT_EQUAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.IN.html">semantique.operators.IN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.NOT_IN.html">semantique.operators.NOT_IN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.GREATER.html">semantique.operators.GREATER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.GREATER_EQUAL.html">semantique.operators.GREATER_EQUAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.LESS.html">semantique.operators.LESS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.LESS_EQUAL.html">semantique.operators.LESS_EQUAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.INTERSECTS.html">semantique.operators.INTERSECTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.AFTER.html">semantique.operators.AFTER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.BEFORE.html">semantique.operators.BEFORE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.operators.DURING.html">semantique.operators.DURING</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.MEAN.html">semantique.reducers.MEAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.MEDIAN.html">semantique.reducers.MEDIAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.MODE.html">semantique.reducers.MODE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.MAX.html">semantique.reducers.MAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.MIN.html">semantique.reducers.MIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.RANGE.html">semantique.reducers.RANGE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.N.html">semantique.reducers.N</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.PRODUCT.html">semantique.reducers.PRODUCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.STANDARD_DEVIATION.html">semantique.reducers.STANDARD_DEVIATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.SUM.html">semantique.reducers.SUM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.VARIANCE.html">semantique.reducers.VARIANCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.ALL.html">semantique.reducers.ALL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.ANY.html">semantique.reducers.ANY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.NONE.html">semantique.reducers.NONE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.COUNT.html">semantique.reducers.COUNT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.PERCENTAGE.html">semantique.reducers.PERCENTAGE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.FIRST.html">semantique.reducers.FIRST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.reducers.LAST.html">semantique.reducers.LAST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.core.QueryProcessor.html">semantique.processor.core.QueryProcessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.arrays.Array.html">semantique.processor.arrays.Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.arrays.Collection.html">semantique.processor.arrays.Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.values.Interval.html">semantique.processor.values.Interval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.not_.html">semantique.processor.operators.not_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.is_missing_.html">semantique.processor.operators.is_missing_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.not_missing_.html">semantique.processor.operators.not_missing_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.absolute_.html">semantique.processor.operators.absolute_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.exponential_.html">semantique.processor.operators.exponential_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.cube_root_.html">semantique.processor.operators.cube_root_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.natural_logarithm_.html">semantique.processor.operators.natural_logarithm_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.square_root_.html">semantique.processor.operators.square_root_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.floor_.html">semantique.processor.operators.floor_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.ceiling_.html">semantique.processor.operators.ceiling_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.cosine_.html">semantique.processor.operators.cosine_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.sine_.html">semantique.processor.operators.sine_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.tangent_.html">semantique.processor.operators.tangent_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.secant_.html">semantique.processor.operators.secant_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.cosecant_.html">semantique.processor.operators.cosecant_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.cotangent_.html">semantique.processor.operators.cotangent_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.to_degrees_.html">semantique.processor.operators.to_degrees_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.to_radians_.html">semantique.processor.operators.to_radians_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.add_.html">semantique.processor.operators.add_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.divide_.html">semantique.processor.operators.divide_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.multiply_.html">semantique.processor.operators.multiply_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.power_.html">semantique.processor.operators.power_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.subtract_.html">semantique.processor.operators.subtract_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.normalized_difference_.html">semantique.processor.operators.normalized_difference_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.and_.html">semantique.processor.operators.and_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.or_.html">semantique.processor.operators.or_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.exclusive_or_.html">semantique.processor.operators.exclusive_or_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.equal_.html">semantique.processor.operators.equal_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.not_equal_.html">semantique.processor.operators.not_equal_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.in_.html">semantique.processor.operators.in_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.not_in_.html">semantique.processor.operators.not_in_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.greater_.html">semantique.processor.operators.greater_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.greater_equal_.html">semantique.processor.operators.greater_equal_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.less_.html">semantique.processor.operators.less_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.less_equal_.html">semantique.processor.operators.less_equal_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.intersects_.html">semantique.processor.operators.intersects_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.after_.html">semantique.processor.operators.after_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.before_.html">semantique.processor.operators.before_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.operators.during_.html">semantique.processor.operators.during_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.mean_.html">semantique.processor.reducers.mean_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.median_.html">semantique.processor.reducers.median_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.mode_.html">semantique.processor.reducers.mode_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.max_.html">semantique.processor.reducers.max_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.min_.html">semantique.processor.reducers.min_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.range_.html">semantique.processor.reducers.range_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.n_.html">semantique.processor.reducers.n_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.product_.html">semantique.processor.reducers.product_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.standard_deviation_.html">semantique.processor.reducers.standard_deviation_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.sum_.html">semantique.processor.reducers.sum_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.variance_.html">semantique.processor.reducers.variance_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.all_.html">semantique.processor.reducers.all_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.any_.html">semantique.processor.reducers.any_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.none_.html">semantique.processor.reducers.none_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.count_.html">semantique.processor.reducers.count_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.percentage_.html">semantique.processor.reducers.percentage_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.first_.html">semantique.processor.reducers.first_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.reducers.last_.html">semantique.processor.reducers.last_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.parse_extent.html">semantique.processor.utils.parse_extent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.parse_datetime_component.html">semantique.processor.utils.parse_datetime_component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.get_null.html">semantique.processor.utils.get_null</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.allnull.html">semantique.processor.utils.allnull</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.null_as_zero.html">semantique.processor.utils.null_as_zero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.inf_as_null.html">semantique.processor.utils.inf_as_null</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.datetime64_as_unix.html">semantique.processor.utils.datetime64_as_unix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.utils.convert_datetime64.html">semantique.processor.utils.convert_datetime64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.types.TypePromoter.html">semantique.processor.types.TypePromoter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.types.get_value_type.html">semantique.processor.types.get_value_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.types.get_value_labels.html">semantique.processor.types.get_value_labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.types.DTYPE_MAPPING.html">semantique.processor.types.DTYPE_MAPPING</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.processor.types.TYPE_PROMOTION_MANUALS.html">semantique.processor.types.TYPE_PROMOTION_MANUALS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.AlignmentError.html">semantique.exceptions.AlignmentError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.EmptyDataError.html">semantique.exceptions.EmptyDataError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.InvalidValueTypeError.html">semantique.exceptions.InvalidValueTypeError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.InvalidIntervalError.html">semantique.exceptions.InvalidIntervalError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.InvalidBuildingBlockError.html">semantique.exceptions.InvalidBuildingBlockError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownConceptError.html">semantique.exceptions.UnknownConceptError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownLayerError.html">semantique.exceptions.UnknownLayerError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownResultError.html">semantique.exceptions.UnknownResultError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownVerbError.html">semantique.exceptions.UnknownVerbError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownReducerError.html">semantique.exceptions.UnknownReducerError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownOperatorError.html">semantique.exceptions.UnknownOperatorError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownDimensionError.html">semantique.exceptions.UnknownDimensionError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownComponentError.html">semantique.exceptions.UnknownComponentError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.UnknownLabelError.html">semantique.exceptions.UnknownLabelError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.TooManyDimensionsError.html">semantique.exceptions.TooManyDimensionsError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.MissingDimensionError.html">semantique.exceptions.MissingDimensionError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.MixedDimensionsError.html">semantique.exceptions.MixedDimensionsError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.ReservedDimensionError.html">semantique.exceptions.ReservedDimensionError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated/semantique.exceptions.MixedTimeZonesError.html">semantique.exceptions.MixedTimeZonesError</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ZGIS/semantique">GitHub repository</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ZGIS/semantique" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ZGIS/semantique/edit/main/docs/source/_notebooks/processor.nblink" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ZGIS/semantique/issues/new?title=Issue%20on%20page%20%2F_notebooks/processor.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_notebooks/processor.nblink" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.nblink</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Internal query processing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Content">Content</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Prepare">Prepare</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Query-parsing">Query parsing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Parsing-the-spatial-and-temporal-extent">Parsing the spatial and temporal extent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Query-optimization">Query optimization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Query-execution">Query execution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Handler-functions">Handler functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Data-structures">Data structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Tracking-value-types">Tracking value types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-custom-verbs">Adding custom verbs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-custom-operators">Adding custom operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-custom-reducers">Adding custom reducers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Exporting-the-response">Exporting the response</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Logging-progress">Logging progress</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>Explore this notebook interactively: <a class="reference external" href="https://mybinder.org/v2/gh/ZGIS/semantique/HEAD?labpath=demo%2F_notebooks/processor.nblink"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></p>
<section id="Internal-query-processing">
<h1>Internal query processing<a class="headerlink" href="#Internal-query-processing" title="Link to this heading">#</a></h1>
<p>A semantic query is processed by a query processor. In semantique, this query processor is internally modelled as an object of class <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.html">QueryProcessor</a>, which can be seen as a worker class taking care of all tasks involving query processing. An instance of this class is initialized whenever a query recipe is executed within a specific context. That is, whenever you call the
<a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.QueryRecipe.execute.html">execute()</a> method of a <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.QueryRecipe.html">QueryRecipe</a> instance, semantique internally creates a query processor object to take care of all processing tasks.</p>
<p>The query processor processes a query in three three core phases: query parsing, query optimization and query execution. These align with the common phases in regular relational database querying. Each of these phases has their own, dedicated method. In this notebook we will explain in more detail how each phase is implemented in semantique.</p>
<section id="Content">
<h2>Content<a class="headerlink" href="#Content" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#Query-parsing"><span class="std std-ref">Query parsing</span></a></p></li>
<li><p><a class="reference internal" href="#Query-optimization"><span class="std std-ref">Query optimization</span></a></p></li>
<li><p><a class="reference internal" href="#Query-execution"><span class="std std-ref">Query execution</span></a></p></li>
<li><p><a class="reference internal" href="#Logging-progress"><span class="std std-ref">Logging progress</span></a></p></li>
</ul>
</section>
<section id="Prepare">
<h2>Prepare<a class="headerlink" href="#Prepare" title="Link to this heading">#</a></h2>
<p>Import packages:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import semantique as sq
from semantique.processor.core import QueryProcessor
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import geopandas as gpd
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import xarray as xr
import copy
import json
</pre></div>
</div>
</div>
<p>Load a query recipe:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Load a mapping.
with open(&quot;files/recipe.json&quot;, &quot;r&quot;) as file:
    recipe = sq.QueryRecipe(json.load(file))
</pre></div>
</div>
</div>
<p>Set the context of query execution:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Load a mapping.
with open(&quot;files/mapping.json&quot;, &quot;r&quot;) as file:
    mapping = sq.mapping.Semantique(json.load(file))

# Represent an EO data cube.
with open(&quot;files/layout.json&quot;, &quot;r&quot;) as file:
    dc = sq.datacube.GeotiffArchive(json.load(file), src = &quot;files/layers.zip&quot;)

# Set the spatio-temporal extent.
space = sq.SpatialExtent(gpd.read_file(&quot;files/footprint.geojson&quot;))
time = sq.TemporalExtent(&quot;2019-01-01&quot;, &quot;2020-12-31&quot;)

# Collect the full context.
# Including additional configuration parameters.
context = {
    &quot;datacube&quot;: dc,
    &quot;mapping&quot;: mapping,
    &quot;space&quot;: space,
    &quot;time&quot;: time,
    &quot;crs&quot;: 3035,
    &quot;tz&quot;: &quot;UTC&quot;,
    &quot;spatial_resolution&quot;: [-1500, 1500]
}
</pre></div>
</div>
</div>
</section>
<section id="Query-parsing">
<h2>Query parsing<a class="headerlink" href="#Query-parsing" title="Link to this heading">#</a></h2>
<p>During query parsing, all required components for processing (i.e., the query recipe, the mapping, the EO data cube, the spatial and temporal extents, and the additional configuration parameters) are read and converted all together into a single object which will be used internally for further processing of the query. Hence, query parsing takes care of initializing a query processor instance. Therefore, the
<a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.parse.html">parse()</a> method of the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.html">QueryProcessor</a> is implemented as a <a class="reference external" href="https://www.programiz.com/python-programming/methods/built-in/classmethod">classmethod</a>).</p>
<p>One of the main tasks of the query parser is to parse the provided spatial and temporal extents into a single spatio-temporal array, see <a class="reference internal" href="#Parsing-the-spatial-and-temporal-extent"><span class="std std-ref">below</span></a>. This array is used as a template array when retrieving data values from the EO data cube. Ideally, parsing should also take care of validating the components and their interrelations. For example, it should check if referenced concepts in the provided query recipe are actually defined in the provided
ontology. Such functionality is not implemented yet in the current version of semantique.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>processor = QueryProcessor.parse(recipe, **context)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>type(processor)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
semantique.processor.core.QueryProcessor
</pre></div></div>
</div>
<section id="Parsing-the-spatial-and-temporal-extent">
<h3>Parsing the spatial and temporal extent<a class="headerlink" href="#Parsing-the-spatial-and-temporal-extent" title="Link to this heading">#</a></h3>
<p>To parse the spatial and temporal extent into a single spatio-temporal array, the query parser calls the utility function <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.utils.parse_extent.html">parse_extent()</a>. The result is a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object with a spatial and a temporal dimension. The workflow is as follows:</p>
<ol class="arabic simple">
<li><p>The spatial extent is <em>reprojected</em> and <em>rasterized</em> given the specified coordinate reference system and spatial resolution in the configuration parameters. The resulting array is always rectangular and therefore covers the full <em>bounding box</em> of the area that was orginally given as spatial extent. Cells that don’t overlap with the area boundaries itself are filled with nodata values. Others are filled with an integer index. If the given area consisted of a single feature, they are all
indexed with a value of 1. If the given area consisted of multiple disconnected features, each feature gets a different index value.</p></li>
<li><p>The spatial array is <em>expanded</em> over a time dimension. The time dimension has two coordinates: the first coordinate value corresponds to the timestamp at the start of the given time interval, and the second coordinate value corresponds to the timestamp at the end of the given time interval. The time values are <em>converted</em> into the specified time zone in the configuration parameters.</p></li>
<li><p>The spatio-temporal array is <em>trimmed</em>, meaning that coordinates for which all pixel values are nodata, are removed from the array. The spatial dimensions are treated differently, by trimming it only at the edges, and thus maintaining the regularity of the spatial dimensions.</p></li>
</ol>
<p>You can call the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.utils.create_extent_cube.html">parse_extent()</a> function directly to create a spatio-temporal extent cube from respectively a spatial and temporal extent. It may occur that due to the reprojection of the provided spatial extent, some pixels at the edges of the extent get a nodata value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.processor.utils import parse_extent
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>extent = parse_extent(
    spatial_extent = context[&quot;space&quot;],
    temporal_extent = context[&quot;time&quot;],
    spatial_resolution = context[&quot;spatial_resolution&quot;],
    crs = context[&quot;crs&quot;],
    tz = context[&quot;tz&quot;]
)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>extent
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;index&#x27; (time: 2, y: 4, x: 4)&gt;
array([[[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]],

       [[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]]])
Coordinates:
  * time           (time) datetime64[ns] 2019-01-01 2020-12-31
  * y              (y) float64 2.696e+06 2.695e+06 2.693e+06 2.692e+06
  * x              (x) float64 4.531e+06 4.532e+06 4.534e+06 4.535e+06
    spatial_ref    int64 0
    spatial_feats  (y, x) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
    temporal_ref   int64 0
Attributes:
    name:          index
    long_name:     index
    _FillValue:    nan
    value_type:    nominal
    value_labels:  {1: &#x27;feature_1&#x27;}</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'index'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>y</span>: 4</li><li><span class='xr-has-index'>x</span>: 4</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-80eab7d2-c5bb-46b0-807a-7e4d5fa24db7' class='xr-array-in' type='checkbox' checked><label for='section-80eab7d2-c5bb-46b0-807a-7e4d5fa24db7' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0</span></div><div class='xr-array-data'><pre>array([[[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]],

       [[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]]])</pre></div></div></li><li class='xr-section-item'><input id='section-47bd2e55-15c9-4441-b9b0-ccf3cadb6a8e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-47bd2e55-15c9-4441-b9b0-ccf3cadb6a8e' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-01-01 2020-12-31</div><input id='attrs-a058929c-71ba-4497-8e32-4886195feef0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a058929c-71ba-4497-8e32-4886195feef0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d7c0deb-4704-4f85-a931-a8054914fc1e' class='xr-var-data-in' type='checkbox'><label for='data-5d7c0deb-4704-4f85-a931-a8054914fc1e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>value_type :</span></dt><dd>datetime</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-01-01T00:00:00.000000000&#x27;, &#x27;2020-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.696e+06 2.695e+06 ... 2.692e+06</div><input id='attrs-927228b3-ba85-4c33-a13f-2ee5ed0e08fb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-927228b3-ba85-4c33-a13f-2ee5ed0e08fb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a953cec1-c1cd-476d-ab1d-9f62fd089857' class='xr-var-data-in' type='checkbox'><label for='data-a953cec1-c1cd-476d-ab1d-9f62fd089857' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd><dt><span>value_type :</span></dt><dd>continuous</dd><dt><span>resolution :</span></dt><dd>-1500</dd></dl></div><div class='xr-var-data'><pre>array([2696250., 2694750., 2693250., 2691750.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.531e+06 4.532e+06 ... 4.535e+06</div><input id='attrs-682fcf52-7978-40d1-8915-3ac676be6d74' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-682fcf52-7978-40d1-8915-3ac676be6d74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5e8266a7-5760-49c9-88fd-442829551664' class='xr-var-data-in' type='checkbox'><label for='data-5e8266a7-5760-49c9-88fd-442829551664' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd><dt><span>value_type :</span></dt><dd>continuous</dd><dt><span>resolution :</span></dt><dd>1500</dd></dl></div><div class='xr-var-data'><pre>array([4530750., 4532250., 4533750., 4535250.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-f39c39af-cd41-47ec-9658-4c47d4655c69' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f39c39af-cd41-47ec-9658-4c47d4655c69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b19a3e6-487a-4a33-8bac-f6f9ab948ee9' class='xr-var-data-in' type='checkbox'><label for='data-6b19a3e6-487a-4a33-8bac-f6f9ab948ee9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;ETRS89-extended / LAEA Europe&quot;,GEOGCS[&quot;ETRS89&quot;,DATUM[&quot;European_Terrestrial_Reference_System_1989&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6258&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4258&quot;]],PROJECTION[&quot;Lambert_Azimuthal_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,52],PARAMETER[&quot;longitude_of_center&quot;,10],PARAMETER[&quot;false_easting&quot;,4321000],PARAMETER[&quot;false_northing&quot;,3210000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Northing&quot;,NORTH],AXIS[&quot;Easting&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;3035&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314140356</dd><dt><span>inverse_flattening :</span></dt><dd>298.257222101</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>GRS 1980</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>ETRS89</dd><dt><span>horizontal_datum_name :</span></dt><dd>European Terrestrial Reference System 1989</dd><dt><span>projected_crs_name :</span></dt><dd>ETRS89-extended / LAEA Europe</dd><dt><span>grid_mapping_name :</span></dt><dd>lambert_azimuthal_equal_area</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>52.0</dd><dt><span>longitude_of_projection_origin :</span></dt><dd>10.0</dd><dt><span>false_easting :</span></dt><dd>4321000.0</dd><dt><span>false_northing :</span></dt><dd>3210000.0</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;ETRS89-extended / LAEA Europe&quot;,GEOGCS[&quot;ETRS89&quot;,DATUM[&quot;European_Terrestrial_Reference_System_1989&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6258&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4258&quot;]],PROJECTION[&quot;Lambert_Azimuthal_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,52],PARAMETER[&quot;longitude_of_center&quot;,10],PARAMETER[&quot;false_easting&quot;,4321000],PARAMETER[&quot;false_northing&quot;,3210000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Northing&quot;,NORTH],AXIS[&quot;Easting&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;3035&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>4530000.0 1500.0 0.0 2697000.0 0.0 -1500.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_feats</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</div><input id='attrs-f2957869-f45a-439e-8d67-28df8d37b6b7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f2957869-f45a-439e-8d67-28df8d37b6b7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0890167f-7e05-4c33-8fe7-fb1fe8c381c4' class='xr-var-data-in' type='checkbox'><label for='data-0890167f-7e05-4c33-8fe7-fb1fe8c381c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>value_type :</span></dt><dd>nominal</dd><dt><span>value_labels :</span></dt><dd>{1: &#x27;feature_1&#x27;}</dd></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., 1.],
       [1., 1., 1., 1.],
       [1., 1., 1., 1.],
       [1., 1., 1., 1.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temporal_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-39fe281b-8beb-447c-9c80-6aed84ae0ccd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-39fe281b-8beb-447c-9c80-6aed84ae0ccd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0346b84d-80e1-41ab-8b07-1f5444e9480a' class='xr-var-data-in' type='checkbox'><label for='data-0346b84d-80e1-41ab-8b07-1f5444e9480a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>zone :</span></dt><dd>UTC</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fe4c1070-2833-417e-855a-9d16114929d1' class='xr-section-summary-in' type='checkbox'  ><label for='section-fe4c1070-2833-417e-855a-9d16114929d1' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fc1cb675-7a7c-4aec-8a97-d956ce1b0bd3' class='xr-index-data-in' type='checkbox'/><label for='index-fc1cb675-7a7c-4aec-8a97-d956ce1b0bd3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([2696250.0, 2694750.0, 2693250.0, 2691750.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5636d60e-8397-49f2-b4d0-d5c5a2daf348' class='xr-index-data-in' type='checkbox'/><label for='index-5636d60e-8397-49f2-b4d0-d5c5a2daf348' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([4530750.0, 4532250.0, 4533750.0, 4535250.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-eb3e77cb-61d6-4e99-a69d-caaf469b4669' class='xr-index-data-in' type='checkbox'/><label for='index-eb3e77cb-61d6-4e99-a69d-caaf469b4669' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2019-01-01&#x27;, &#x27;2020-12-31&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-656a3177-6b8b-4017-acd7-0a00332eb509' class='xr-section-summary-in' type='checkbox'  checked><label for='section-656a3177-6b8b-4017-acd7-0a00332eb509' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>index</dd><dt><span>long_name :</span></dt><dd>index</dd><dt><span>_FillValue :</span></dt><dd>nan</dd><dt><span>value_type :</span></dt><dd>nominal</dd><dt><span>value_labels :</span></dt><dd>{1: &#x27;feature_1&#x27;}</dd></dl></div></li></ul></div></div></div>
</div>
</section>
</section>
<section id="Query-optimization">
<h2>Query optimization<a class="headerlink" href="#Query-optimization" title="Link to this heading">#</a></h2>
<p>During query optimization, the query components are scanned and certain properties of the query processor are set. These properties influence some tweaks in how the query processor will behave when processing the query. For example, if the given spatial extent consists of multiple dispersed sub-areas, the query processor might instruct itself to load data separately for each sub-area, instead of loading data for the full extent and then subset it afterwards.</p>
<p>The query processor contains the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.optimize.html">optimize()</a> method to run the optimization phase. It returns the same instance, but with updated properties. However, in the current version of semantique, the optimization phase only exists as a placeholder, and no properties are updated yet.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>processor = processor.optimize()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>type(processor)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
semantique.processor.core.QueryProcessor
</pre></div></div>
</div>
</section>
<section id="Query-execution">
<h2>Query execution<a class="headerlink" href="#Query-execution" title="Link to this heading">#</a></h2>
<p>Finally, the execution phase is where the query recipe is executed. The query processor contains the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.execute.html">execute()</a> method to run this phase. It returns the response of the query as a dictionary containing the outputs of all formulated results in the query recipe. Each of these outputs is a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>response = processor.execute()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>response
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;blue_map&#39;: &lt;xarray.DataArray &#39;blue_map&#39; (y: 4, x: 4)&gt;
 array([[1., 0., 0., 0.],
        [0., 0., 0., 1.],
        [1., 0., 1., 0.],
        [0., 0., 0., 0.]])
 Coordinates:
   * x              (x) float64 4.531e+06 4.532e+06 4.534e+06 4.535e+06
   * y              (y) float64 2.696e+06 2.695e+06 2.693e+06 2.692e+06
     spatial_ref    int64 0
     temporal_ref   int64 0
     spatial_feats  (y, x) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
 Attributes:
     value_type:  discrete,
 &#39;green_map&#39;: &lt;xarray.DataArray &#39;green_map&#39; (y: 4, x: 4)&gt;
 array([[1., 2., 1., 2.],
        [2., 2., 0., 1.],
        [1., 1., 0., 1.],
        [2., 0., 1., 2.]])
 Coordinates:
   * x              (x) float64 4.531e+06 4.532e+06 4.534e+06 4.535e+06
   * y              (y) float64 2.696e+06 2.695e+06 2.693e+06 2.692e+06
     spatial_ref    int64 0
     temporal_ref   int64 0
     spatial_feats  (y, x) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
 Attributes:
     value_type:  discrete,
 &#39;blue_curve&#39;: &lt;xarray.DataArray &#39;blue_curve&#39; (time: 3)&gt;
 array([0., 1., 3.])
 Coordinates:
     spatial_ref   int64 0
   * time          (time) datetime64[ns] 2019-12-15T10:17:33.408715 ... 2020-1...
     temporal_ref  int64 0
 Attributes:
     value_type:  discrete,
 &#39;green_curve&#39;: &lt;xarray.DataArray &#39;green_curve&#39; (time: 3)&gt;
 array([ 0., 13.,  6.])
 Coordinates:
     spatial_ref   int64 0
   * time          (time) datetime64[ns] 2019-12-15T10:17:33.408715 ... 2020-1...
     temporal_ref  int64 0
 Attributes:
     value_type:  discrete,
 &#39;blue_stat&#39;: &lt;xarray.DataArray &#39;blue_stat&#39; ()&gt;
 array(4.)
 Coordinates:
     spatial_ref   int64 0
     temporal_ref  int64 0
 Attributes:
     value_type:  discrete,
 &#39;green_stat&#39;: &lt;xarray.DataArray &#39;green_stat&#39; ()&gt;
 array(19.)
 Coordinates:
     spatial_ref   int64 0
     temporal_ref  int64 0
 Attributes:
     value_type:  discrete}
</pre></div></div>
</div>
<section id="Handler-functions">
<h3>Handler functions<a class="headerlink" href="#Handler-functions" title="Link to this heading">#</a></h3>
<p>When executing a query recipe, the query processor moves through the building blocks of the result instructions. For each building block, it has a specific handler function implemented as a method. Whenever the processor reaches a new block, it looks up its type and then calls its handler with the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.call_handler.html">call_handler()</a> method. For example, the
<a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.handle_concept.html">handle_concept()</a> method knows how to call the translator of the provided mapping in order to translate a textual semantic concept reference into a semantic array. while the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.core.QueryProcessor.handle_reduce.html">handle_reduce()</a> method know how to apply the reduce verb to such an array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>processor.handle_concept(sq.entity(&quot;vegetation&quot;))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;vegetation&#x27; (time: 3, y: 4, x: 4)&gt;
array([[[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[1., 1., 1., 1.],
        [1., 1., 0., 1.],
        [1., 1., 0., 1.],
        [1., 0., 1., 1.]],

       [[0., 1., 0., 1.],
        [1., 1., 0., 0.],
        [0., 0., 0., 0.],
        [1., 0., 0., 1.]]])
Coordinates:
  * x              (x) float64 4.531e+06 4.532e+06 4.534e+06 4.535e+06
  * y              (y) float64 2.696e+06 2.695e+06 2.693e+06 2.692e+06
    spatial_ref    int64 0
  * time           (time) datetime64[ns] 2019-12-15T10:17:33.408715 ... 2020-...
    temporal_ref   int64 0
    spatial_feats  (y, x) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
Attributes:
    AREA_OR_POINT:  Area
    scale_factor:   1.0
    add_offset:     0.0
    _FillValue:     1.7976931348623157e+308
    value_type:     binary</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'vegetation'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 3</li><li><span class='xr-has-index'>y</span>: 4</li><li><span class='xr-has-index'>x</span>: 4</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-852856ac-c223-4817-a5dd-a21b39035b3d' class='xr-array-in' type='checkbox' checked><label for='section-852856ac-c223-4817-a5dd-a21b39035b3d' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 1.0 0.0 0.0 1.0</span></div><div class='xr-array-data'><pre>array([[[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[1., 1., 1., 1.],
        [1., 1., 0., 1.],
        [1., 1., 0., 1.],
        [1., 0., 1., 1.]],

       [[0., 1., 0., 1.],
        [1., 1., 0., 0.],
        [0., 0., 0., 0.],
        [1., 0., 0., 1.]]])</pre></div></div></li><li class='xr-section-item'><input id='section-fc7abf24-28ce-443e-aa45-5cf0d9888c0d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fc7abf24-28ce-443e-aa45-5cf0d9888c0d' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.531e+06 4.532e+06 ... 4.535e+06</div><input id='attrs-d24bef88-be95-4853-8f24-7cfd059e77a6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d24bef88-be95-4853-8f24-7cfd059e77a6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98e086cc-9651-4e91-adf3-a29e2f1694b9' class='xr-var-data-in' type='checkbox'><label for='data-98e086cc-9651-4e91-adf3-a29e2f1694b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>1500</dd><dt><span>value_type :</span></dt><dd>continuous</dd></dl></div><div class='xr-var-data'><pre>array([4530750., 4532250., 4533750., 4535250.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.696e+06 2.695e+06 ... 2.692e+06</div><input id='attrs-c0424f48-ee3e-4cad-8fa2-358c08fd0132' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c0424f48-ee3e-4cad-8fa2-358c08fd0132' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4cf9d367-9610-42a3-83ee-7ef8f5e570a5' class='xr-var-data-in' type='checkbox'><label for='data-4cf9d367-9610-42a3-83ee-7ef8f5e570a5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-1500</dd><dt><span>value_type :</span></dt><dd>continuous</dd></dl></div><div class='xr-var-data'><pre>array([2696250., 2694750., 2693250., 2691750.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-f8f9b938-d33e-480f-9033-a78182351e56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f8f9b938-d33e-480f-9033-a78182351e56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a38e21c-bf73-40da-b030-d5f993515755' class='xr-var-data-in' type='checkbox'><label for='data-7a38e21c-bf73-40da-b030-d5f993515755' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;ETRS89-extended / LAEA Europe&quot;,GEOGCS[&quot;ETRS89&quot;,DATUM[&quot;European_Terrestrial_Reference_System_1989&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6258&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4258&quot;]],PROJECTION[&quot;Lambert_Azimuthal_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,52],PARAMETER[&quot;longitude_of_center&quot;,10],PARAMETER[&quot;false_easting&quot;,4321000],PARAMETER[&quot;false_northing&quot;,3210000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Northing&quot;,NORTH],AXIS[&quot;Easting&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;3035&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314140356</dd><dt><span>inverse_flattening :</span></dt><dd>298.257222101</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>GRS 1980</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>ETRS89</dd><dt><span>horizontal_datum_name :</span></dt><dd>European Terrestrial Reference System 1989</dd><dt><span>projected_crs_name :</span></dt><dd>ETRS89-extended / LAEA Europe</dd><dt><span>grid_mapping_name :</span></dt><dd>lambert_azimuthal_equal_area</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>52.0</dd><dt><span>longitude_of_projection_origin :</span></dt><dd>10.0</dd><dt><span>false_easting :</span></dt><dd>4321000.0</dd><dt><span>false_northing :</span></dt><dd>3210000.0</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;ETRS89-extended / LAEA Europe&quot;,GEOGCS[&quot;ETRS89&quot;,DATUM[&quot;European_Terrestrial_Reference_System_1989&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6258&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4258&quot;]],PROJECTION[&quot;Lambert_Azimuthal_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,52],PARAMETER[&quot;longitude_of_center&quot;,10],PARAMETER[&quot;false_easting&quot;,4321000],PARAMETER[&quot;false_northing&quot;,3210000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Northing&quot;,NORTH],AXIS[&quot;Easting&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;3035&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>4530000.0 1500.0 0.0 2697000.0 0.0 -1500.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-12-15T10:17:33.408715 ... 2...</div><input id='attrs-bf38c7a1-a01d-4774-8ec1-425cccf37dd8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bf38c7a1-a01d-4774-8ec1-425cccf37dd8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bad93d77-b4c7-4384-9c3e-aa23e9e85bcb' class='xr-var-data-in' type='checkbox'><label for='data-bad93d77-b4c7-4384-9c3e-aa23e9e85bcb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>value_type :</span></dt><dd>datetime</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-12-15T10:17:33.408715000&#x27;, &#x27;2020-09-05T10:17:43.167942000&#x27;,
       &#x27;2020-12-19T10:17:34.610661000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temporal_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-95dbfef3-9373-4c65-b5c2-2345a54d2c16' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-95dbfef3-9373-4c65-b5c2-2345a54d2c16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba63c509-0275-4051-b7f2-92b00ae3b0cc' class='xr-var-data-in' type='checkbox'><label for='data-ba63c509-0275-4051-b7f2-92b00ae3b0cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>zone :</span></dt><dd>UTC</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_feats</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</div><input id='attrs-74ad560c-72dd-4167-988c-bdb11d3afb9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-74ad560c-72dd-4167-988c-bdb11d3afb9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f1e4a9e-b26b-4122-b55d-ec01b6cd4714' class='xr-var-data-in' type='checkbox'><label for='data-2f1e4a9e-b26b-4122-b55d-ec01b6cd4714' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>value_type :</span></dt><dd>nominal</dd><dt><span>value_labels :</span></dt><dd>{1: &#x27;feature_1&#x27;}</dd></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., 1.],
       [1., 1., 1., 1.],
       [1., 1., 1., 1.],
       [1., 1., 1., 1.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6ef9978c-eebb-47d7-874d-c1b26c76b019' class='xr-section-summary-in' type='checkbox'  ><label for='section-6ef9978c-eebb-47d7-874d-c1b26c76b019' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9baf5248-17bb-4278-bba7-d5d574d836c6' class='xr-index-data-in' type='checkbox'/><label for='index-9baf5248-17bb-4278-bba7-d5d574d836c6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([4530750.0, 4532250.0, 4533750.0, 4535250.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5c7aac0e-6516-4123-a5f2-8f1fc4af358b' class='xr-index-data-in' type='checkbox'/><label for='index-5c7aac0e-6516-4123-a5f2-8f1fc4af358b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([2696250.0, 2694750.0, 2693250.0, 2691750.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0a928afc-9ad6-4344-9804-3c0f7e6624a5' class='xr-index-data-in' type='checkbox'/><label for='index-0a928afc-9ad6-4344-9804-3c0f7e6624a5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2019-12-15 10:17:33.408715&#x27;, &#x27;2020-09-05 10:17:43.167942&#x27;,
               &#x27;2020-12-19 10:17:34.610661&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2f3de53f-2136-4ba2-8e50-b7392228a295' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2f3de53f-2136-4ba2-8e50-b7392228a295' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd><dt><span>_FillValue :</span></dt><dd>1.7976931348623157e+308</dd><dt><span>value_type :</span></dt><dd>binary</dd></dl></div></li></ul></div></div></div>
</div>
</section>
<section id="Data-structures">
<h3>Data structures<a class="headerlink" href="#Data-structures" title="Link to this heading">#</a></h3>
<p>Internally the query processor uses <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> objects from the <a class="reference external" href="https://docs.xarray.dev/en/stable/">xarray</a> package to represent multi-dimensional arrays. It extends these objects by adding a so-called <em>accessor</em> with the name <strong>sq</strong>. In practice, this means that all semantique-specific methods and properties for these objects can be called on any
<a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object through the <code class="docutils literal notranslate"><span class="pre">.sq</span></code> prefix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xarray_object</span><span class="o">.</span><span class="n">sq</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
<span class="n">xarray_object</span><span class="o">.</span><span class="n">sq</span><span class="o">.</span><span class="n">property</span>
</pre></div>
</div>
<p>Extending xarray in this way is recommended by its developers. Read more about it <a class="reference external" href="https://docs.xarray.dev/en/stable/internals/extending-xarray.html">here</a>. The semantique-specific properties for data arrays include for example the <a class="reference internal" href="#Tracking-value-types"><span class="std std-ref">value type</span></a> of the cube as well as spatio-temporal properties like the spatial resolution, the coordinate reference system in which the spatial coordinates are expressed and the time zone in which the temporal coordinates are expressed.
The semantique-specific methods for data arrays include all the implemented verbs, as well as other functionalities that are internally used by the query processor, such as unstacking and aligning arrays. Finally, there are methods for conversions to other objects or to files on disk. For all semantique specific methods and properties for data arrays, see the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.arrays.Array.html">API
reference</a>.</p>
<p>For collections of multiple arrays, semantique contains the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.arrays.Collection.html">Collection</a> class. This is simply a list of <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> objects. Its methods include the verbs for array collections, as well as some single-array methods that are mapped over each member of the collection.</p>
<p>For all specific methods and properties of these objects, see the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.structures.CubeCollection.html">API reference</a>. To ensure compatible behaviour with single arrays, you may call all these methods and properties as well with the prefix <code class="docutils literal notranslate"><span class="pre">.sq</span></code>. However, this is not an xarray accessor, and merely provided to simplify internal code.</p>
</section>
<section id="Tracking-value-types">
<h3>Tracking value types<a class="headerlink" href="#Tracking-value-types" title="Link to this heading">#</a></h3>
<p>When moving through the building blocks of a query recipe, the query processor keeps track of the <em>value type</em> of the wrangled arrays. Such a value type describes what kind of data the array contains. It differs from the very technical, computer-oriented <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.dtypes.html">numpy.dtype</a> categorization, which contains e.g. <em>int</em>, <em>float</em>, etc. Instead, the <em>value type</em> describes data on a more general, statistical level.</p>
<p>Currently semantique makes a distinction between two value types for quantitative data:</p>
<ul class="simple">
<li><p>Continuous</p></li>
<li><p>Discrete</p></li>
</ul>
<p>And three value types for qualitative data:</p>
<ul class="simple">
<li><p>Nominal</p></li>
<li><p>Ordinal</p></li>
<li><p>Binary</p></li>
</ul>
<p>Additional value types exist for spatio-temporal data:</p>
<ul class="simple">
<li><p>datetime (for timestamps)</p></li>
<li><p>coords (for spatial coordinate tuples)</p></li>
<li><p>geometry (for spatial geometries stored <a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.html">GeoDataFrame</a> objects)</p></li>
</ul>
<p>It is expected that whenever an array is retrieved from the EO data cube, the corresponding value type is stored as an semantique-specific array attribute <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.arrays.Array.value_type.html">value_type</a>. Even when the data are not qualitative, they are usually stored as numbers. In these cases, an additional attribute <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.arrays.Array.value_labels.html">value_labels</a>
may be used to define the mapping between character-encoded <em>labels</em> and integer-encoded <em>indices</em>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>colors = dc.retrieve(&quot;appearance&quot;, &quot;colortype&quot;, extent = extent)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>colors.sq.value_type
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;ordinal&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>colors.sq.value_labels
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{1: &#39;SVHNIR&#39;,
 2: &#39;SVLNIR&#39;,
 3: &#39;AVHNIR&#39;,
 4: &#39;AVLNIR&#39;,
 5: &#39;WV&#39;,
 6: &#39;SHV&#39;,
 7: &#39;SHRBRHNIR&#39;,
 8: &#39;SHRBRLNIR&#39;,
 9: &#39;HRBCR&#39;,
 10: &#39;WR&#39;,
 11: &#39;PB&#39;,
 12: &#39;GH&#39;,
 13: &#39;VBBB&#39;,
 14: &#39;BBB&#39;,
 15: &#39;SBB&#39;,
 16: &#39;ABB&#39;,
 17: &#39;DBB&#39;,
 18: &#39;WBBorSHB&#39;,
 19: &#39;NIRPBB&#39;,
 20: &#39;BA&#39;,
 21: &#39;DPWASH&#39;,
 22: &#39;SLWASH&#39;,
 23: &#39;TWASH&#39;,
 24: &#39;SASLWA&#39;,
 27: &#39;TNCLV&#39;,
 28: &#39;TNCLWA_BB&#39;,
 29: &#39;SN&#39;,
 30: &#39;SHSN&#39;,
 31: &#39;SH&#39;,
 32: &#39;FLAME&#39;}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>water = mapping.translate(&quot;entity&quot;, &quot;water&quot;, extent = extent, datacube = dc)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>water.sq.value_type
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;binary&#39;
</pre></div></div>
</div>
<p>Whenever applying actions to an array, its value type might change. For example, when evaluating an expression (e.g. when evaluating an expression involving a comparison operator the resulting values are always binary) or applying a reducer (e.g. when counting the number of “true” values in a binary array the resulting values are discrete). This is what we also call <strong>type promotion</strong>. Each implemented operator and reducer function is able to promote the type of the output given the type(s) of
the input(s) by using a type promotion manual.</p>
<p>A common type promotion manual for a univariate operator and a reducer has a dictionary structure with as keys the supported input value types. The value of each key is the output value type. For example, the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.reducers.count_.html">count()</a> reducer should only be applied to arrays containing binary data, since it counts the number of “true” values. The output of that operation, however, is an array with discrete quantitative
data. Hence, the corresponding type promotion manual looks like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.processor.types import TYPE_PROMOTION_MANUALS
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>TYPE_PROMOTION_MANUALS[&quot;count&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;binary&#39;: &#39;discrete&#39;, &#39;__preserve_labels__&#39;: 0}
</pre></div></div>
</div>
<p>The additional key “preserve_labels” defines if value labels should be preserved after the reducer is applied, with 0 being “no” and 1 being “yes”.</p>
<p>The reduction function will apply the type promotion whenever <code class="docutils literal notranslate"><span class="pre">track_types</span> <span class="pre">=</span> <span class="pre">True</span></code>, which is the default. When we apply the count reducer to a binary array, this means the value type of the output will be discrete:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.processor import reducers
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new = water.sq.reduce(reducers.count_, &quot;time&quot;)
new.sq.value_type
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;discrete&#39;
</pre></div></div>
</div>
<p>Now, when we call this reducer function on e.g. an ordinal array instead of a binary array, an <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.exceptions.InvalidValueTypeError.html">InvalidValueTypeError</a> will be thrown. Hence, the query processor uses type tracking also to <em>check</em> type promotions, and thus, to detect invalid operations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.exceptions import InvalidValueTypeError
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    colors.sq.reduce(reducers.count_, &quot;time&quot;)
except InvalidValueTypeError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unsupported operand value type(s) for &#39;count&#39;: [[&#39;ordinal&#39;]]
</pre></div></div>
</div>
<p>This will not happen when <code class="docutils literal notranslate"><span class="pre">track_types</span> <span class="pre">=</span> <span class="pre">False</span></code>. In that case, value types are not tracked and the output array has no value type at all.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new = colors.sq.reduce(reducers.count_, &quot;time&quot;, track_types = False)
&quot;value_type&quot; in new.attrs
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
<p>For bivariate expressions, the type promotion manuals have an extra “layer” for the second operand. The first layer of keys refers to the value type of the first operand (i.e. x) and the second layer of keys to the value type of the second operand (i.e. y). For example, the boolean operator <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.operators.and_.html">and()</a> accepts only arrays with binary values, and returns binary values as well. Hence, the corresponding type
promotion manual looks like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>TYPE_PROMOTION_MANUALS[&quot;and&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;binary&#39;: {&#39;binary&#39;: &#39;binary&#39;}, &#39;__preserve_labels__&#39;: 1}
</pre></div></div>
</div>
<p>In the case of these bivariate operators, the “preserve_labels” key may also have a value of 2, meaning that instead of the labels of the first operand, the labels of the second operand should be preserved (this is the case e.g. with the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.operators.assign_.html">assign()</a> operator).</p>
<p>Just as with the reducers, the operators promote the value type of the output based on the manual, and throw an error if a combination of types is not supported.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.processor import operators
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new = water.sq.evaluate(operators.and_, water)
new.sq.value_type
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;binary&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    colors.sq.evaluate(operators.and_, water)
except InvalidValueTypeError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unsupported operand value type(s) for &#39;and&#39;: [[&#39;ordinal&#39;], [&#39;binary&#39;]]
</pre></div></div>
</div>
<p>If the second operand in a bivariate expression is not an array but a single value, its value type is determined based on its <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.dtypes.html">numpy data type</a>. In semantique, each of these numpy data types is mapped to one or more semantique value types. In the case of a mapping to multiple value types, all operations supporting at least one of these types will accept the value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.processor.types import DTYPE_MAPPING
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>DTYPE_MAPPING
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;b&#39;: [&#39;binary&#39;],
 &#39;i&#39;: [&#39;continuous&#39;, &#39;discrete&#39;, &#39;ordinal&#39;, &#39;nominal&#39;],
 &#39;u&#39;: [&#39;continuous&#39;, &#39;discrete&#39;, &#39;ordinal&#39;, &#39;nominal&#39;],
 &#39;f&#39;: [&#39;continuous&#39;],
 &#39;M&#39;: [&#39;datetime&#39;],
 &#39;O&#39;: [&#39;ordinal&#39;, &#39;nominal&#39;],
 &#39;U&#39;: [&#39;ordinal&#39;, &#39;nominal&#39;]}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new = water.sq.evaluate(operators.and_, True)
new.sq.value_type
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;binary&#39;
</pre></div></div>
</div>
<p>Inside the reducer and operator functions, an instance of the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.types.TypePromoter.html">TypePromoter</a> class is the worker that actually takes care of the type promotion. It can be initialized by providing it with the operand(s) of the process, and the name of the function. Then, it will find the type promotion manual belonging to that function. Alternatively (e.g. when you add your own reducers or operators, see the next
sections) you can provide it your own custom type promotion manual.</p>
<p>The promoter can determine the value types of the operands and check if they are supported by the operation. Subsequently, it can promote the value type of the operation output.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.processor.types import TypePromoter
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>promoter = TypePromoter(water, colors, function = &quot;and&quot;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    promoter.check()
except InvalidValueTypeError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unsupported operand value type(s) for &#39;and&#39;: [[&#39;binary&#39;], [&#39;ordinal&#39;]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>promoter = TypePromoter(water, water, function = &quot;and&quot;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>promoter.check()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>promoter.promote(new)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;water&#x27; (time: 3, y: 4, x: 4)&gt;
array([[[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 1., 0.],
        [0., 0., 0., 0.]],

       [[1., 0., 0., 0.],
        [0., 0., 0., 1.],
        [1., 0., 0., 0.],
        [0., 0., 0., 0.]]])
Coordinates:
  * x              (x) float64 4.531e+06 4.532e+06 4.534e+06 4.535e+06
  * y              (y) float64 2.696e+06 2.695e+06 2.693e+06 2.692e+06
    spatial_ref    int64 0
  * time           (time) datetime64[ns] 2019-12-15T10:17:33.408715 ... 2020-...
    temporal_ref   int64 0
    spatial_feats  (y, x) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
Attributes:
    AREA_OR_POINT:  Area
    scale_factor:   1.0
    add_offset:     0.0
    _FillValue:     1.7976931348623157e+308
    value_type:     binary</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'water'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 3</li><li><span class='xr-has-index'>y</span>: 4</li><li><span class='xr-has-index'>x</span>: 4</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-658df8e1-10e3-461e-8d0b-7b2c6fd97bfd' class='xr-array-in' type='checkbox' checked><label for='section-658df8e1-10e3-461e-8d0b-7b2c6fd97bfd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 1., 0.],
        [0., 0., 0., 0.]],

       [[1., 0., 0., 0.],
        [0., 0., 0., 1.],
        [1., 0., 0., 0.],
        [0., 0., 0., 0.]]])</pre></div></div></li><li class='xr-section-item'><input id='section-46fafc58-f517-4839-b498-4976cb7e1697' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46fafc58-f517-4839-b498-4976cb7e1697' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.531e+06 4.532e+06 ... 4.535e+06</div><input id='attrs-e7ba9f2b-61cf-4555-a606-9ff344446627' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e7ba9f2b-61cf-4555-a606-9ff344446627' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea7f7b54-156d-41c4-a0d9-34ccc6aa9dea' class='xr-var-data-in' type='checkbox'><label for='data-ea7f7b54-156d-41c4-a0d9-34ccc6aa9dea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>1500</dd><dt><span>value_type :</span></dt><dd>continuous</dd></dl></div><div class='xr-var-data'><pre>array([4530750., 4532250., 4533750., 4535250.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.696e+06 2.695e+06 ... 2.692e+06</div><input id='attrs-bf23dbb8-2469-43fa-8851-d499f496ac90' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bf23dbb8-2469-43fa-8851-d499f496ac90' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aad975d2-a501-47d5-9cf4-f66f6145428f' class='xr-var-data-in' type='checkbox'><label for='data-aad975d2-a501-47d5-9cf4-f66f6145428f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-1500</dd><dt><span>value_type :</span></dt><dd>continuous</dd></dl></div><div class='xr-var-data'><pre>array([2696250., 2694750., 2693250., 2691750.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-d2dc12fa-d3e1-4704-a7fc-ebae42ad3d6d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2dc12fa-d3e1-4704-a7fc-ebae42ad3d6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a44e74c-0a5b-4d3d-8f73-4a249f9a7c88' class='xr-var-data-in' type='checkbox'><label for='data-7a44e74c-0a5b-4d3d-8f73-4a249f9a7c88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;ETRS89-extended / LAEA Europe&quot;,GEOGCS[&quot;ETRS89&quot;,DATUM[&quot;European_Terrestrial_Reference_System_1989&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6258&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4258&quot;]],PROJECTION[&quot;Lambert_Azimuthal_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,52],PARAMETER[&quot;longitude_of_center&quot;,10],PARAMETER[&quot;false_easting&quot;,4321000],PARAMETER[&quot;false_northing&quot;,3210000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Northing&quot;,NORTH],AXIS[&quot;Easting&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;3035&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314140356</dd><dt><span>inverse_flattening :</span></dt><dd>298.257222101</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>GRS 1980</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>ETRS89</dd><dt><span>horizontal_datum_name :</span></dt><dd>European Terrestrial Reference System 1989</dd><dt><span>projected_crs_name :</span></dt><dd>ETRS89-extended / LAEA Europe</dd><dt><span>grid_mapping_name :</span></dt><dd>lambert_azimuthal_equal_area</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>52.0</dd><dt><span>longitude_of_projection_origin :</span></dt><dd>10.0</dd><dt><span>false_easting :</span></dt><dd>4321000.0</dd><dt><span>false_northing :</span></dt><dd>3210000.0</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;ETRS89-extended / LAEA Europe&quot;,GEOGCS[&quot;ETRS89&quot;,DATUM[&quot;European_Terrestrial_Reference_System_1989&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101,AUTHORITY[&quot;EPSG&quot;,&quot;7019&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6258&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4258&quot;]],PROJECTION[&quot;Lambert_Azimuthal_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,52],PARAMETER[&quot;longitude_of_center&quot;,10],PARAMETER[&quot;false_easting&quot;,4321000],PARAMETER[&quot;false_northing&quot;,3210000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Northing&quot;,NORTH],AXIS[&quot;Easting&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;3035&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>4530000.0 1500.0 0.0 2697000.0 0.0 -1500.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-12-15T10:17:33.408715 ... 2...</div><input id='attrs-f5a86ef1-475b-420e-890a-93127d420f9d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f5a86ef1-475b-420e-890a-93127d420f9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eff41c7b-2c5b-4cdc-8516-5342bc42ff7c' class='xr-var-data-in' type='checkbox'><label for='data-eff41c7b-2c5b-4cdc-8516-5342bc42ff7c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>value_type :</span></dt><dd>datetime</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-12-15T10:17:33.408715000&#x27;, &#x27;2020-09-05T10:17:43.167942000&#x27;,
       &#x27;2020-12-19T10:17:34.610661000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temporal_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-d04a74b9-7c95-45ff-8cc8-2e0b2b2a0094' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d04a74b9-7c95-45ff-8cc8-2e0b2b2a0094' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba9c45d2-0d5b-477f-9361-de2a6832acc8' class='xr-var-data-in' type='checkbox'><label for='data-ba9c45d2-0d5b-477f-9361-de2a6832acc8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>zone :</span></dt><dd>UTC</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_feats</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</div><input id='attrs-ad79ca09-ce26-40e8-ab2f-dd54216b3e8d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ad79ca09-ce26-40e8-ab2f-dd54216b3e8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e41ccccf-370d-40f6-b70b-b54ecfbf4f3c' class='xr-var-data-in' type='checkbox'><label for='data-e41ccccf-370d-40f6-b70b-b54ecfbf4f3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>value_type :</span></dt><dd>nominal</dd><dt><span>value_labels :</span></dt><dd>{1: &#x27;feature_1&#x27;}</dd></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., 1.],
       [1., 1., 1., 1.],
       [1., 1., 1., 1.],
       [1., 1., 1., 1.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-18f7274b-7c1b-45fd-bbbe-009188b358c4' class='xr-section-summary-in' type='checkbox'  ><label for='section-18f7274b-7c1b-45fd-bbbe-009188b358c4' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-740526d8-9752-459e-acf8-7315c24f9e1a' class='xr-index-data-in' type='checkbox'/><label for='index-740526d8-9752-459e-acf8-7315c24f9e1a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([4530750.0, 4532250.0, 4533750.0, 4535250.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-16c5ad67-fa7a-40cc-890d-fa433bbc3b06' class='xr-index-data-in' type='checkbox'/><label for='index-16c5ad67-fa7a-40cc-890d-fa433bbc3b06' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([2696250.0, 2694750.0, 2693250.0, 2691750.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d3805df9-1125-44eb-ac29-005bd285593f' class='xr-index-data-in' type='checkbox'/><label for='index-d3805df9-1125-44eb-ac29-005bd285593f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2019-12-15 10:17:33.408715&#x27;, &#x27;2020-09-05 10:17:43.167942&#x27;,
               &#x27;2020-12-19 10:17:34.610661&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d1bda856-5588-4b40-8a81-4db0fd745549' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d1bda856-5588-4b40-8a81-4db0fd745549' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd><dt><span>_FillValue :</span></dt><dd>1.7976931348623157e+308</dd><dt><span>value_type :</span></dt><dd>binary</dd></dl></div></li></ul></div></div></div>
</div>
<p>Now what if you don’t want the query processor to track types at all? There are several reasons why you’d want to do so. For example, type tracking can be so strict that it limits your flexibility of using certain processes “out of the box”. Some EO data cube layouts may not specify value types at all, and some custom operators or reducers that you use may not have any type promotion manual. Also, type tracking of course takes time and thus decreases query performance. No worries, it is easy to
tell the query processor to <em>not</em> track types. Simply add the configuration parameter “track_types” when initializing the query processor, and set its value to <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">context</span><span class="p">[</span><span class="s2">&quot;track_types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</section>
<section id="Adding-custom-verbs">
<h3>Adding custom verbs<a class="headerlink" href="#Adding-custom-verbs" title="Link to this heading">#</a></h3>
<p>Besides the built-in semantique verbs, there is the option to provide your own set of custom verb functions when initializing the query processor. Each custom verb requires a name and a callable function. The function has to accept a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object as its first argument. This is the <em>active evaluation object</em> in the processing chain, to which the verb is applied. It must also contain a boolean keyword argument
called “track_types”, which defines if <a class="reference internal" href="#Tracking-value-types"><span class="std std-ref">value type tracking</span></a> should be applied. Hence, the function should also be able to track value types if this is requested. You can add as many additional keyword arguments as you want. The return value of the function must again be a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object. Internally, semantique will forward your function and the keyword arguments to the
<a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.pipe.html">pipe()</a> method in xarray. Only use this functionality if you really know what you are doing!</p>
<p>Lets create a trivial custom verb that simply assigns a true value (i.e. 1) to each pixel in an array.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def make_true(obj, track_types = True, **kwargs):
    newobj = obj.copy(deep = True)
    newobj.values = np.ones_like(newobj)
    if track_types:
        newobj.sq.value_type = &quot;binary&quot;
        del obj.sq.value_labels
    return newobj
</pre></div>
</div>
</div>
<p>When executing a query recipe, we can now add this custom verb to the configuration parameters as a dictionary with the function name as a key and the function itself as a value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new_recipe = sq.QueryRecipe()
new_context = copy.deepcopy(context)

new_recipe[&quot;vals&quot;] = sq.reflectance(&quot;s2_band04&quot;)
new_recipe[&quot;ones&quot;] = sq.result(&quot;vals&quot;).apply_custom(&quot;make_true&quot;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.exceptions import UnknownVerbError
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    print(new_recipe.execute(**new_context)[&quot;ones&quot;])
except UnknownVerbError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Custom verb &#39;make_true&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new_context[&quot;custom_verbs&quot;] = {&quot;make_true&quot;: make_true}
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    print(new_recipe.execute(**new_context)[&quot;ones&quot;])
except UnknownVerbError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;ones&#39; (time: 3, y: 4, x: 4)&gt;
array([[[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]],

       [[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]],

       [[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]]])
Coordinates:
  * x              (x) float64 4.531e+06 4.532e+06 4.534e+06 4.535e+06
  * y              (y) float64 2.696e+06 2.695e+06 2.693e+06 2.692e+06
    spatial_ref    int64 0
  * time           (time) datetime64[ns] 2019-12-15T10:17:33.408715 ... 2020-...
    temporal_ref   int64 0
    spatial_feats  (y, x) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
Attributes:
    AREA_OR_POINT:  Area
    scale_factor:   1.0
    add_offset:     0.0
    _FillValue:     1.7976931348623157e+308
    value_type:     binary
</pre></div></div>
</div>
</section>
<section id="Adding-custom-operators">
<h3>Adding custom operators<a class="headerlink" href="#Adding-custom-operators" title="Link to this heading">#</a></h3>
<p>Operators are used when evaluating expressions on arrays with the <a class="reference external" href="https://zgis.github.io/semantique/_notebooks/verbs.html#Evaluate">evaluate()</a> verb. For example, you can compare each value in an array with a given constant (using e.g. the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.operators.greater_.html">greater()</a> operator), add two arrays together (using the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.operators.add_.html">add()</a>
operator), etcetera. When creating a query recipe, you can refer to these operators by their name, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sq</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="s2">&quot;water_count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the operator functions are taken from the <a class="reference external" href="https://zgis.github.io/semantique/reference.html#operator-functions">operators module</a> of semantique. This is the module in which all built-in operator functions are defined. However, when initializing a query processor you can provide a set of additional operator functions that may be used during query execution.</p>
<p>Let us prepare such a custom operator. This requires a name, an operator function and a type promotion manual. If you plan to disable type tracking either way, the latter is of course not needed. An operator function has to accept a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object as its first argument. This is the <em>active evaluation object</em> in the processing chain, to which the verb is applied. Bivariate operators also accept a second argument,
which can either be a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object as well, or a single value. The return value of the operator must again be a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object. Usually it is a good idea to use the <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.apply_ufunc.html">xarray.apply_ufunc()</a> function inside operator functions, as shown below. Also, you
should not forget to align the second operand to the input object before applying the core operation!</p>
<p>It is also possible to implement operator functions with more than two operands. All additional keyword arguments that the evaluate verb receives are simply forwarded to the operator function. You could for example build a query recipe like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sq</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="s2">&quot;water_count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s2">&quot;custom&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">foo</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bar</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>You then need to implement an operator with four arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">custom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to <a class="reference internal" href="#Tracking-value-types"><span class="std std-ref">track value types</span></a>, the custom operator should also have a binary “track_types” argument. Inside the function, the type promotion should be applied whenever the “track_types” argument is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. You can create your own type promotion manual and provide it to the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.types.TypePromoter.html">TypePromoter</a> instance through the “manual” argument, or use the type promotion manual of a
built-in operator function by providing the name of that function through the “function” argument.</p>
<p>Lets create a custom operator that calculates the modulus of two arrays.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def modulus(x, y, track_types = True, **kwargs):
    if track_types:
        manual = {&quot;continuous&quot;: {&quot;continuous&quot;: &quot;continuous&quot;}, &quot;__preserve_labels&quot;: 0}
        promoter = TypePromoter(x, y, manual = manual)
        promoter.check()
    f = lambda x, y: np.mod(x, y)
    y = xr.DataArray(y).sq.align_with(x)
    out = xr.apply_ufunc(f, x, y)
    if track_types:
        out = promoter.promote(out)
    return out
</pre></div>
</div>
</div>
<p>When executing a query recipe, we can now add this custom operator to the configuration parameters as a dictionary with the function name as a key and the function itself as a value. Note that if a custom operator has the same name as a default operator, the default operator will be replaced by the custom operator.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new_recipe = sq.QueryRecipe()
new_context = copy.deepcopy(context)

red = sq.reflectance(&quot;s2_band04&quot;)
nir = sq.reflectance(&quot;s2_band08&quot;)

new_recipe[&quot;mod&quot;] = nir.evaluate(&quot;modulus&quot;, red).evaluate(&quot;floor&quot;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.exceptions import UnknownOperatorError
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    print(new_recipe.execute(**new_context)[&quot;mod&quot;])
except UnknownOperatorError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Operator &#39;modulus&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new_context[&quot;custom_operators&quot;] = {&quot;modulus&quot;: modulus}
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    print(new_recipe.execute(**new_context)[&quot;mod&quot;])
except UnknownOperatorError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;mod&#39; (time: 3, y: 4, x: 4)&gt;
array([[[ 434.,  530.,  553.,  856.],
        [ 499.,  725.,  291.,  378.],
        [ 427.,  530., 2690.,  310.],
        [ 644.,  231.,  317.,  656.]],

       [[ 211.,  273.,  195.,  255.],
        [ 245.,   61.,  367.,  229.],
        [ 210.,   20.,  188.,  288.],
        [  77.,  709.,  136.,  172.]],

       [[ 314.,  161.,  737.,  101.],
        [ 752.,  340.,  409.,  247.],
        [ 344.,  724., 1085.,   64.],
        [ 387., 1549.,  556.,  369.]]])
Coordinates:
  * x              (x) float64 4.531e+06 4.532e+06 4.534e+06 4.535e+06
  * y              (y) float64 2.696e+06 2.695e+06 2.693e+06 2.692e+06
    spatial_ref    int64 0
  * time           (time) datetime64[ns] 2019-12-15T10:17:33.408715 ... 2020-...
    temporal_ref   int64 0
    spatial_feats  (y, x) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
Attributes:
    value_type:  discrete
</pre></div></div>
</div>
</section>
<section id="Adding-custom-reducers">
<h3>Adding custom reducers<a class="headerlink" href="#Adding-custom-reducers" title="Link to this heading">#</a></h3>
<p>Reducers are used inside the <a class="reference external" href="https://zgis.github.io/semantique/_notebooks/verbs.html#Reduce">reduce()</a> verb as a function to aggregate values along a dimension of an array. For example, you can reduce the temporal dimension of an array by calculating the average value of each slice along the time dimension axis (using the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.reducers.mean_.html">mean()</a> reducer), etcetera. When creating a query recipe, you can refer to these
reducers by their name, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sq</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="s2">&quot;water_count_space&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the reducer functions are taken from the <a class="reference external" href="https://zgis.github.io/semantique/reference.html#reducer-functions">reducers module</a> of semantique. This is the module in which all built-in reducer functions are defined. However, when initializing a query processor you can provide a set of additional reducer functions that may be used during query execution.</p>
<p>Let us prepare such a custom reducer. This requires a name, a reducer function and a type promotion manual. If you plan to disable type tracking either way, the latter is of course not needed. A reducer function has to accept a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object as its first argument. This is the <em>active evaluation object</em> in the processing chain, to which the verb is applied. The return value of the reducer must again be a
<a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object. Usually it is a good idea to use the <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.reduce.html">xarray.reduce()</a> method inside reducer functions, as shown below. This function will take care e.g. of translating the dimension name (if provided) into its corresponding axis number.</p>
<p>A reducer function also needs to accept additional keyword arguments. Two of them are “reserved”, and should never be used for a custom argument: “dim” for the name of the dimension to reduce over, and “axis” for the axis number belonging to that dimension. All other keyword arguments are simply forwarded to the reducer function. That allows you to include additional variables in your reducer functions (e.g. constants).</p>
<p>If you want to <a class="reference internal" href="#Tracking-value-types"><span class="std std-ref">track value types</span></a>, the custom reducer should also have a binary “track_types” argument. Inside the function, the type promotion should be applied whenever the “track_types” argument is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. You can create your own type promotion manual and provide it to the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.types.TypePromoter.html">TypePromoter</a> instance through the “manual” argument, or use the type promotion manual of a
built-in reducer function by providing the name of that function through the “function” argument.</p>
<p>Lets create a custom operator that reduces a set of values to its sum of squares.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def sum_of_squares(x, track_types = False, **kwargs):
    if track_types:
        promoter = TypePromoter(x, function = &quot;sum&quot;)
        promoter.check()
    f = lambda x, axis = None: np.sum(np.square(x), axis)
    out = x.reduce(f, **kwargs)
    if track_types:
        promoter.promote(out)
    return out
</pre></div>
</div>
</div>
<p>When executing a query recipe, we can now add this custom reducer to the configuration parameters as a dictionary with the function name as a key and the function itself as a value. Note that if a custom reducer has the same name as a default reducer, the default reducer will be replaced by the custom reducer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new_recipe = sq.QueryRecipe()
new_context = copy.deepcopy(context)

nir = sq.reflectance(&quot;s2_band08&quot;)

new_recipe[&quot;foo&quot;] = nir.reduce(&quot;sum_of_squares&quot;, &quot;space&quot;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from semantique.exceptions import UnknownReducerError
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    print(new_recipe.execute(**new_context)[&quot;foo&quot;])
except UnknownReducerError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reducer &#39;sum_of_squares&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>new_context[&quot;custom_reducers&quot;] = {&quot;sum_of_squares&quot;: sum_of_squares}
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    print(new_recipe.execute(**new_context)[&quot;foo&quot;])
except UnknownReducerError as e:
    print(e)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;foo&#39; (time: 3)&gt;
array([2.1983427e+08, 5.3802670e+07, 3.9970504e+07])
Coordinates:
    spatial_ref   int64 0
  * time          (time) datetime64[ns] 2019-12-15T10:17:33.408715 ... 2020-1...
    temporal_ref  int64 0
Attributes:
    value_type:  continuous
</pre></div></div>
</div>
</section>
<section id="Exporting-the-response">
<h3>Exporting the response<a class="headerlink" href="#Exporting-the-response" title="Link to this heading">#</a></h3>
<p>Each array in the response is a <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">DataArray</a> object, and can thus be further processed with one of the many functions that the <a class="reference external" href="https://docs.xarray.dev/en/stable/">xarray</a> package has to offer. It is also possible to convert a response to another format. Semantique contains functions to convert an array to a <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">DataFrame</a> object from the
<a class="reference external" href="https://pandas.pydata.org/">pandas</a> package, and to a <a class="reference external" href="https://geopandas.org/docs/reference/api/geopandas.GeoDataFrame.html">GeoDataFrame</a> object from the <a class="reference external" href="https://geopandas.org/en/stable/">geopandas</a> package (requires spatial dimensions). These conversion methods can be called through the <a class="reference internal" href="#Data-structures"><span class="std std-ref">sq-accessor</span></a> of the arrays.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>response[&quot;blue_curve&quot;].sq.to_dataframe()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>blue_curve</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-12-15 10:17:33.408715</th>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-09-05 10:17:43.167942</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2020-12-19 10:17:34.610661</th>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>response[&quot;blue_map&quot;].sq.to_geodataframe()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
      <th>x</th>
      <th>blue_map</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2696250.0</td>
      <td>4530750.0</td>
      <td>1.0</td>
      <td>POINT (4530750.000 2696250.000)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2696250.0</td>
      <td>4532250.0</td>
      <td>0.0</td>
      <td>POINT (4532250.000 2696250.000)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2696250.0</td>
      <td>4533750.0</td>
      <td>0.0</td>
      <td>POINT (4533750.000 2696250.000)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2696250.0</td>
      <td>4535250.0</td>
      <td>0.0</td>
      <td>POINT (4535250.000 2696250.000)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2694750.0</td>
      <td>4530750.0</td>
      <td>0.0</td>
      <td>POINT (4530750.000 2694750.000)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2694750.0</td>
      <td>4532250.0</td>
      <td>0.0</td>
      <td>POINT (4532250.000 2694750.000)</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2694750.0</td>
      <td>4533750.0</td>
      <td>0.0</td>
      <td>POINT (4533750.000 2694750.000)</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2694750.0</td>
      <td>4535250.0</td>
      <td>1.0</td>
      <td>POINT (4535250.000 2694750.000)</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2693250.0</td>
      <td>4530750.0</td>
      <td>1.0</td>
      <td>POINT (4530750.000 2693250.000)</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2693250.0</td>
      <td>4532250.0</td>
      <td>0.0</td>
      <td>POINT (4532250.000 2693250.000)</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2693250.0</td>
      <td>4533750.0</td>
      <td>1.0</td>
      <td>POINT (4533750.000 2693250.000)</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2693250.0</td>
      <td>4535250.0</td>
      <td>0.0</td>
      <td>POINT (4535250.000 2693250.000)</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2691750.0</td>
      <td>4530750.0</td>
      <td>0.0</td>
      <td>POINT (4530750.000 2691750.000)</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2691750.0</td>
      <td>4532250.0</td>
      <td>0.0</td>
      <td>POINT (4532250.000 2691750.000)</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2691750.0</td>
      <td>4533750.0</td>
      <td>0.0</td>
      <td>POINT (4533750.000 2691750.000)</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2691750.0</td>
      <td>4535250.0</td>
      <td>0.0</td>
      <td>POINT (4535250.000 2691750.000)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Semantique also allow to export an array to either a CSV file or a GeoTIFF file (requires spatial dimensions). To do so, call respectively the <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.arrays.Array.to_csv.html">to_csv</a> or <a class="reference external" href="https://zgis.github.io/semantique/_generated/semantique.processor.arrays.Array.to_geotiff.html">to_geotiff</a> methods through the <a class="reference internal" href="#Data-structures"><span class="std std-ref">sq-accessor</span></a> of the arrays.</p>
</section>
</section>
<section id="Logging-progress">
<h2>Logging progress<a class="headerlink" href="#Logging-progress" title="Link to this heading">#</a></h2>
<p>When processing a query, the query processor logs its progress. Most of these logs are of the “DEBUG” level. They are helpful to debug the query processing, since they show intermediate outputs when the query processor iterates through the building blocks in the query recipe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import logging
import sys

logger = logging.getLogger(&quot;semantique.processor.core&quot;)
logger.setLevel(logging.DEBUG)
logger.addHandler(logging.FileHandler(filename = &quot;files/logs.txt&quot;, mode = &quot;w&quot;))
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>response = recipe.execute(**context)
</pre></div>
</div>
</div>
<p>See <a class="reference external" href="https://github.com/ZGIS/semantique/blob/main/demo/files/logs.txt">here</a> the logs file we created.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="verbs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Verbs</p>
      </div>
    </a>
    <a class="right-next"
       href="../reference.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Content">Content</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Prepare">Prepare</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Query-parsing">Query parsing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Parsing-the-spatial-and-temporal-extent">Parsing the spatial and temporal extent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Query-optimization">Query optimization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Query-execution">Query execution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Handler-functions">Handler functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Data-structures">Data structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Tracking-value-types">Tracking value types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-custom-verbs">Adding custom verbs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-custom-operators">Adding custom operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-custom-reducers">Adding custom reducers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Exporting-the-response">Exporting the response</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Logging-progress">Logging progress</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021, Department of Geoinformatics – Z_GIS.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>